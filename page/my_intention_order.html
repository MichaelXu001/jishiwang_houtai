<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>我的意向单</title>
    <link rel="stylesheet" href="./../css/common.css">
    <link rel="stylesheet" href="./../css/style.css">
    <link rel="stylesheet" href="./../css/laypage.css">

</head>

<body>
    <div class="nav">
        <div class="leftgroup">
            <div class="logo" id="logo">
                <a href="/"></a>
            </div>
            <div class="telescopic shrink" id="telescopic"><img src="./../images/zd.png" alt=""></div>
        </div>
        <div class="rightgroup">
            <ul>
                <li class="name"><a href="">旭阳科技</a></li>
                <li class="intentionOrder"><a href="">意向单</a></li>
                <li class="legalService"><a href="">法律服务</a></li>
                <li class="quit" id="quit"><a href="javascript:void(0);">退出</a></li>
            </ul>
            <div class="namePic"><img alt=""></div>
        </div>
    </div>
    <div class="main">
        <div class="container">
            <div class="rightMain" id="rightMain">
                <div class="projectType" id="projectType">
                    <ul>
                        <li class="active" data_status="3">全部意向单</li>
                        <li data_status="1">未确认意向单</li>
                        <li data_status="2">已确认意向单</li>
                    </ul>
                    <div class="searchBox">
                        <div class="searchBtn"></div>
                        <input type="text" placeholder="搜索" class="searchInput" id="searchInput">
                    </div>
                </div>
                <ul class="orderType" id="orderType">
                    <li data_type="000">全部类型</li>
                    <li data_type="101">机械施工一体化</li>
                    <li data_type="201">工程机械厂家</li>
                    <li data_type="301">工程机械租赁</li>
                </ul>
                <div class="OrderList" id="OrderList">
                    <!-- <div class="everyList">
                    <div class="topInfor">
                        <div class="firstInfor fl">
                            <div class="times fl">2017-08-24 12:00:00</div>
                            <div class="orderId fl">订单号：<span>12332212</span></div>
                            <div class="brandName fl">阿特拉斯佳斯公司（北京）</div>
                        </div>
                        <div class="secondInfor fr">
                            买家：<span>张先生 13232323987 5787654567@qq.com</span>
                        </div>
                    </div>
                    <div class="goodsInfor">
                        <div class="goodsImg fl"><img src="./../images/1.jpg" alt=""></div>
                        <div class="goodsName fl">YTG786大汽车</div>
                        <div class="goodsModel fl">AXCDS210</div>
                        <div class="goodsNumber fl">×2</div>
                        <div class="goodsPrice fl">¥1234500</div>
                        <div class="goodsBtn fl">
                            <p>确认</p>
                        </div>
                    </div>
                    <div class="comment">留言： <span>q2发广告那个你噶刚发广告刚刚发给q2发广</span></div>
                </div> -->




                </div>
                <div style="height:32px;margin-bottom:0px;background: #f6f6f6;"></div>
                <div class="pageBox">
                    <div id="page"></div>
                </div>
            </div>
        </div>
        <div class="leftMenu" id="leftMenu">
            <ul>
                <li class="UserCenter">
                    <span><img src="./../images/center.png" alt=""></span>
                    <a href="./index.html">用户中心首页</a>
                </li>
                <li class="myIntentionOrder active">
                    <span><img src="./../images/IntentionOrder.png" alt=""></span>
                    <a href="./my_intention_order.html?type=000&status=3">我的意向单</a>
                </li>
                <li class="myOrder">
                    <span><img src="./../images/order.png" alt=""></span>
                    <a href="./my_order.html?status=0">我的订单</a>
                </li>
                <li class="myShoppingCart">
                    <span><img src="./../images/ShoppingCart.png" alt=""></span>
                    <a href="./my_shopping_cart.html">我的购物车</a>
                </li>
                <li class="myCollection">
                    <span><img src="./../images/Collection.png" alt=""></span>
                    <a href="./my_collection.html?type=000">我的收藏</a>
                </li>
                <li class="customerService">
                    <span><img src="./../images/customer.png" alt=""></span>
                    <a href="">客户服务</a>
                </li>
                <li class="userSettings">
                    <span><img src="./../images/setting.png" alt=""></span>
                    <a href="./user_settings.html">用户设置</a>
                </li>
            </ul>
        </div>

    </div>


    <script src="./../js/jquery.min.js"></script>
    <script src="./../js/common.js"></script>
    <script src="./../js/laypage.js"></script>
    <script>
        var funObj = {
            urlparameter: {
                type: common.Geturl("type"),
                status: common.Geturl("status"),
                fenye: location.hash.replace('#!fenye=', '')
            },
            InterfaceObj: {
                getintentions: "http://39.108.191.122/Consumer/Intentions/getintentions", //意向单
            },
            inits: function() {
                this.IntentionOrderTypeFun();

                this.filterFun();
            },
            IntentionOrderTypeFun: function() {
                if (funObj.urlparameter.type == "000") {
                    $("#orderType li").eq(0).addClass("active").siblings("li").removeClass("active");
                } else if (funObj.urlparameter.type == "101") {
                    $("#orderType li").eq(1).addClass("active").siblings("li").removeClass("active");
                } else if (funObj.urlparameter.type == "201") {
                    $("#orderType li").eq(2).addClass("active").siblings("li").removeClass("active");
                } else if (funObj.urlparameter.type == "301") {
                    $("#orderType li").eq(3).addClass("active").siblings("li").removeClass("active");
                }
                if (funObj.urlparameter.status == 3) {
                    $("#projectType li").eq(0).addClass("active").siblings("li").removeClass("active");
                } else if (funObj.urlparameter.status == 2) {
                    $("#projectType li").eq(2).addClass("active").siblings("li").removeClass("active");
                } else if (funObj.urlparameter.status == 1) {
                    $("#projectType li").eq(1).addClass("active").siblings("li").removeClass("active");
                }
            },
            filterFun: function() {
                var getintentionsObj = {
                    type: funObj.urlparameter.type,
                    status: funObj.urlparameter.status, //1  待确认，2 已确认，3 全部
                    page: 1,
                    usertype: 1 //暂时的，上线的时候就去掉了 1:厂商 2:用户   2显示brandName 1不显示brandName
                };
                if (funObj.urlparameter.fenye != "") {
                    getintentionsObj.page = funObj.urlparameter.fenye;
                }
                $("#projectType").on("click", "li", function() {
                    getintentionsObj.status = $(this).attr("data_status");
                    getintentionsObj.page = 1;
                    getintentionsObj.pname = "";
                    $.each($("#orderType").find("li.active"), function(i, v) {
                        getintentionsObj.type = $(v).attr("data_type")
                    });
                    funObj.everyListFun(getintentionsObj);
                    $(this).addClass("active").siblings("li").removeClass("active");
                    var state = {
                        'page_id': 1,
                        'user_id': 5
                    };
                    var title = 'Hello World';
                    var url = '?type=' + getintentionsObj.type + '&status=' + getintentionsObj.status;
                    history.pushState(state, title, url);

                });
                $("#orderType").on("click", "li", function() {
                    getintentionsObj.type = $(this).attr("data_type");
                    getintentionsObj.page = 1;
                    getintentionsObj.pname = "";
                    $.each($("#projectType").find("li.active"), function(i, v) {
                        getintentionsObj.status = $(v).attr("data_status")
                    });
                    funObj.everyListFun(getintentionsObj);
                    $(this).addClass("active").siblings("li").removeClass("active");
                    var state = {
                        'page_id': 1,
                        'user_id': 5
                    };
                    var title = 'Hello World';
                    var url = '?type=' + getintentionsObj.type + '&status=' + getintentionsObj.status;
                    history.pushState(state, title, url);
                });
                $("#searchInput").keypress(function(event) {
                    if (event.which == 13) {
                        getintentionsObj.type = $(this).attr("data_type");
                        getintentionsObj.page = 1;

                        $.each($("#projectType").find("li.active"), function(i, v) {
                            getintentionsObj.status = $(v).attr("data_status")
                        });
                        getintentionsObj.pname = $("#searchInput").val();
                        funObj.everyListFun(getintentionsObj);
                        $(this).addClass("active").siblings("li").removeClass("active");
                        var state = {
                            'page_id': 1,
                            'user_id': 5
                        };
                        var title = 'Hello World';
                        var url = '?type=' + getintentionsObj.type + '&status=' + getintentionsObj.status + '&pname=' + escape($("#searchInput").val());
                        history.pushState(state, title, url);
                    }
                })
                funObj.everyListFun(getintentionsObj);
            },
            everyListFun: function(getintentionsObj) {
                common.ajaxFun(funObj.InterfaceObj.getintentions, "GET", getintentionsObj, function(res) {
                    if (res.status == -1) {
                        alert("查询意向单接口出错了")
                    } else if (res.status == 1) {

                        common.intentionsStr(res, $("#OrderList"), false);
                        common.laypageFun(res.count, getintentionsObj, funObj.InterfaceObj.getintentions, 2);
                    } else if (res.status == -2) {
                        var str = '<div class="noContent" id="noContent">没有相关产品</div>';
                        $("#OrderList").html($(str));
                    }
                });
            }
        }
        funObj.inits();
    </script>
</body>

</html>